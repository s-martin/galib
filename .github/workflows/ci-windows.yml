name: CI-Windows

on: [push]

jobs:
  build:

    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@v3
    - name: Download and install Boost
      uses: MarkusJx/install-boost@v2.4.4
      id: install-boost
      with:
          boost_version: 1.81.0
          toolset: msvc 
          platform_version: 2022
          link: shared # or static
          arch: x86 # is also for AMD64
          # The dirctory to install boost into
          # boost_install_dir: # optional, default is 
          cache: false # doesnt work under windows
    - name: Configure CMake
      run: |
          cmake . -B ./build
      env:
        BOOST_ROOT: ${{ steps.install-boost.outputs.BOOST_ROOT }}
    #- name: install dependencies
    #  run: vcpkg install boost-test boost-program-options boost-predef --triplet x64-windows
    #- name: cmake config
    #  run: |
    #    md build
    #    cd build
    #    cmake ../ -DCMAKE_TOOLCHAIN_FILE=C:/vcpkg/scripts/buildsystems/vcpkg.cmake
    - name: make
      run: cmake --build ./build
    - name: run unit tests
      #working-directory: ./build
      #run: ./test/Debug/GAlibTest.exe
      run: |
        cd build
        ./test/Debug/GAlibTest.exe
